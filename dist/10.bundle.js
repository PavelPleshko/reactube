(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{219:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r){if(Object.prototype.hasOwnProperty.call(r,a)){e[a]=r[a]}}}return e};var s=r(1);var n=P(s);var o=r(49);var i=r(17);var l=r(10);var c=r(117);var u=C(c);var d=r(202);var f=C(d);var h=r(118);var m=r(206);var v=C(m);var p=r(522);var g=P(p);var y=r(198);var S=P(y);var w=r(34);var E=r(511);var b=P(E);var M=r(602);var _=P(M);function C(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function P(e){return e&&e.__esModule?e:{default:e}}const H=e=>({search:{backgroundColor:"rgba(0,0,0,.04)",height:"100%",width:"100%",position:"fixed",top:0,right:0},total:{color:e.palette.primary.grey,fontSize:".8rem",margin:"0 .5rem",fontWeight:400}});class O extends s.Component{constructor(...e){var t;return t=super(...e),this.state={searched:null},this.componentDidMount=(()=>{if(this.props.loggedIn){let{currentPage:e,pageSize:t,historyMedias:r,listHistoryMedia:a}=this.props;if(r.length<1)a(e,t)}}),this.clearHistory=(()=>{this.props.clearHistory()}),this.listHistoryMedia=(()=>{const{currentPage:e,pageSize:t,searchHistory:r,listHistoryMedia:a}=this.props;const{searched:s}=this.state;if(s){r(s,e,t)}else{a(e,t)}}),this.setRootRef=(e=>{this.rootRef=e}),this.changeSearched=(e=>{this.setState({searched:e})}),t}render(){const{classes:e,historyMedias:t,loggedIn:r,isProcessing:a,itemsRequested:s,total:i,noMoreItems:l}=this.props;return n.default.createElement(S.default,{container:true,spacing:24},n.default.createElement(S.default,{item:true,sm:12},n.default.createElement("h3",null,"Medias that you viewed",r&&n.default.createElement("span",{className:e.total},"(",n.default.createElement("strong",null,i)," in total)"))),n.default.createElement(S.default,{item:true,sm:7},n.default.createElement("div",{ref:this.setRootRef},r?t&&t.length?n.default.createElement(g.default,{refContainer:this.rootRef,callback:this.listHistoryMedia,stop:l,requested:s},n.default.createElement(b.default,{items:t,isProcessing:s})):n.default.createElement("div",null," Your view history is empty "):n.default.createElement("div",null,"You have to be logged in to view history.",n.default.createElement(o.Link,{to:"/signin"},"Log in")))),n.default.createElement(S.default,{item:true,sm:3,className:e.search},n.default.createElement(_.default,{changeSearched:this.changeSearched,loggedIn:r,historyCount:t&&t.length})))}}const x=e=>(0,l.bindActionCreators)(a({},u,f),e);const N=e=>({historyMedias:(0,h.selectMedias)(e.media.medias,"history"),currentPage:(0,h.selectCurrentPage)(e.media.medias,"history"),pageSize:(0,h.selectPageSize)(e.media.medias,"history"),total:(0,h.selectTotal)(e.media.medias,"history"),itemsRequested:(0,h.selectIsProcessing)(e.media.medias,"history"),noMoreItems:(0,h.noMoreItems)(e.media.medias,"history"),loggedIn:v.selectIsAuthenticated(e.user),isProcessing:v.selectIsProcessing(e.user)});t.default=(0,i.connect)(N,x)((0,w.withStyles)(H)(O))},485:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r){if(Object.prototype.hasOwnProperty.call(r,a)){e[a]=r[a]}}}return e};var s=r(1);var n=d(s);var o=r(491);var i=d(o);var l=r(34);var c=r(490);var u=d(c);function d(e){return e&&e.__esModule?e:{default:e}}const f=e=>({textInput:{width:"100%"}});class h extends s.Component{render(){const{classes:e,adornment:t,label:r,input:s,type:o,helperText:l,multiline:c}=this.props;return n.default.createElement(i.default,a({label:r,type:o||"text",className:e.textInput},s,{multiline:c,margin:l?"dense":"normal",helperText:l,InputProps:{startAdornment:t&&n.default.createElement(u.default,{position:"start"},t)}}))}}h.defaultProps={helperText:"",multiline:false};t.default=(0,l.withStyles)(f)(h)},488:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const a=e=>{let t="";let r=Math.floor(e/3600);let a=Math.floor(e%3600/60);let s=Math.floor(e%3600%60);t=r>0?r+"h ":"";t+=a>0?a+"min ":"";t+=s>0?s+"s":"";return t};const s=e=>{let t=["Bytes","KB","MB","GB","TB"];if(e==0)return"0 Byte";let r=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,r),2)+" "+t[r]};const n=e=>{const t=new Date(Number(e)*1e3);const r=t.getUTCHours();let a=t.getUTCMinutes();const s=("0"+t.getUTCSeconds()).slice(-2);if(r){a=("0"+t.getUTCMinutes()).slice(-2);return`${r}:${a}:${s}`}return`${a}:${s}`};const o=["January","February","March","April","May","June","July","August","September","October","November","December"];function i(e,t=false,r=false){const a=e.getDate();const s=o[e.getMonth()];const n=e.getFullYear();const i=e.getHours();let l=e.getMinutes();if(l<10){l=`0${l}`}if(t){return`${t} at ${i}:${l}`}if(r){return`${a} ${s} at ${i}:${l}`}return`${a} ${s} ${n}. at ${i}:${l}`}const l=e=>{if(!e){return null}const t=typeof e==="object"?e:new Date(e);const r=864e5;const a=new Date;const s=new Date(a-r);const n=Math.round((a-t)/1e3);const o=Math.round(n/60);const l=a.toDateString()===t.toDateString();const c=s.toDateString()===t.toDateString();const u=a.getFullYear()===t.getFullYear();if(n<5){return"now"}else if(n<60){return`${n} seconds ago`}else if(n<90){return"about a minute ago"}else if(o<60){return`${o} minutes ago`}else if(l){return i(t,"Today")}else if(c){return i(t,"Yesterday")}else if(u){return i(t,false,true)}return i(t)};t.transformSeconds=a;t.transformBytes=s;t.formatDuration=n;t.fromNow=l},508:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(1);var s=E(a);var n=r(197);var o=E(n);var i=r(86);var l=E(i);var c=r(497);var u=E(c);var d=r(496);var f=E(d);var h=r(495);var m=E(h);var v=r(494);var p=E(v);var g=r(493);var y=E(g);var S=r(492);var w=E(S);function E(e){return e&&e.__esModule?e:{default:e}}function b(e,t){var r={};for(var a in e){if(t.indexOf(a)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,a))continue;r[a]=e[a]}return r}const M=e=>{let{open:t,closeDialog:r,resourceTitle:a,confirmDelete:n}=e,i=b(e,["open","closeDialog","resourceTitle","confirmDelete"]);return s.default.createElement("span",null,s.default.createElement(f.default,{open:t},s.default.createElement(m.default,null,i.title?i.title:"Delete "+a),s.default.createElement(p.default,null,i.children?i.children:s.default.createElement(w.default,null,"Confirm to delete ",s.default.createElement("strong",null,a)," from your account.")),s.default.createElement(y.default,null,s.default.createElement(o.default,{onClick:r,color:"primary"},"Cancel"),s.default.createElement(o.default,{onClick:n,variant:"raised",color:"primary",autoFocus:"autoFocus"},"Confirm"))))};t.default=M},509:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});const a=(e,t)=>{if(!e){return t}else{let r=/[\.\,\s\!\?]/i.exec(t.slice(e));return t.length>e?t.slice(0,e+Number(r.index))+"...":t}};t.truncate=a},510:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(1);var s=h(a);var n=r(49);var o=r(509);var i=r(198);var l=h(i);var c=r(86);var u=h(c);var d=r(34);var f=r(488);function h(e){return e&&e.__esModule?e:{default:e}}const m=e=>({icon:{color:e.palette.primary.grey},image:{width:"100%",height:"100%",backgroundSize:"cover",backgroundPosition:"50% 50%",position:"relative"},imageWrapper:{width:"100%",height:140},mediaTitle:{whiteSpace:"normal",overflow:"hidden",textOverflow:"ellipsis",color:"#000000",fontSize:"1.2rem",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":2,fontWeight:500,margin:"5px 0",maxHeight:"3rem",lineHeight:"1.5rem"},meta:{display:"flex",fontSize:".8rem",color:e.palette.primary.grey},separator:{margin:"0 5px"},author:{overflowX:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",fontWeight:500,opacity:.9,marginBottom:"3px","&:hover":{opacity:1,cursor:"pointer"}},description:{marginBottom:8,paddingTop:10,display:"block",color:e.palette.primary.grey,overflow:"hidden",fontSize:".9rem",fontWeight:400}});class v extends a.Component{constructor(...e){var t;return t=super(...e),this.shouldComponentUpdate=(e=>{return this.props.item._id!==e.item._id}),t}render(){const{classes:e,item:t,resourceName:r}=this.props;return s.default.createElement(s.default.Fragment,null,s.default.createElement(l.default,{item:true,sm:5},s.default.createElement(n.Link,{to:`/${r}/${t._id}`},s.default.createElement("div",{className:e.imageWrapper},s.default.createElement("div",{className:e.image,style:{backgroundImage:`url(${t.thumb_url})`}})))),s.default.createElement(l.default,{item:true,sm:7},s.default.createElement(n.Link,{to:`/${r}/${t._id}`},s.default.createElement("h3",{className:e.mediaTitle},t.title)),s.default.createElement("div",{className:e.meta},s.default.createElement("div",{className:e.author},t.postedBy.firstName+" "+t.postedBy.lastName),s.default.createElement("div",{className:e.separator},"•"),s.default.createElement("div",null,t.views," views "),s.default.createElement("div",{className:e.separator},"•"),(0,f.fromNow)(t.created)),s.default.createElement("div",{className:e.description},(0,o.truncate)(120,t.description))))}}t.default=(0,d.withStyles)(m)(v)},511:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(1);var s=f(a);var n=r(198);var o=f(n);var i=r(34);var l=r(204);var c=f(l);var u=r(510);var d=f(u);function f(e){return e&&e.__esModule?e:{default:e}}const h=e=>({loader:{display:"flex",justifyContent:"center"}});const m=e=>{const{columns:t=4,items:r,resourceName:a="media",classes:n,isProcessing:i}=e;return s.default.createElement("div",null,r.map(e=>s.default.createElement(o.default,{container:true,style:{marginBottom:8},spacing:24,key:e._id},s.default.createElement(d.default,{resourceName:a,item:e}))),i&&s.default.createElement("div",{className:n.loader},s.default.createElement(c.default,null)))};t.default=(0,i.withStyles)(h)(m)},522:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=r(1);var s=i(a);var n=r(521);var o=i(n);function i(e){return e&&e.__esModule?e:{default:e}}class l extends a.Component{constructor(...e){var t;return t=super(...e),this.state={reachedBottom:false,scrollListener:null},this.throttledScroll=(0,o.default)(e=>this.handleScroll(e),500),this.handleScroll=(e=>{const{containerHeight:t,gap:r,callback:a,stop:s,requested:n}=this.props;const o=typeof n==="undefined"?true:!n;if(s){this.stopListening()}else{const{scrollY:e}=window;const{offsetTop:s,scrollHeight:n}=this.props.refContainer;if(t+e>s+n-r&&o){if(!this.state.reachedBottom){a();this.setState({reachedBottom:true})}}else{if(this.state.reachedBottom){this.setState({reachedBottom:false})}}}}),this.stopListening=(()=>{if(typeof window!="undefined"){window.removeEventListener("scroll",this.throttledScroll)}}),this.componentDidMount=(()=>{if(typeof window!="undefined"){window.addEventListener("scroll",this.throttledScroll)}}),this.componentWillUnmount=(()=>{this.stopListening()}),t}render(){return this.props.children}}l.defaultProps={gap:50,containerHeight:window.innerHeight};t.default=l},602:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r){if(Object.prototype.hasOwnProperty.call(r,a)){e[a]=r[a]}}}return e};var s=r(1);var n=O(s);var o=r(34);var i=r(197);var l=O(i);var c=r(213);var u=O(c);var d=r(601);var f=O(d);var h=r(600);var m=O(h);var v=r(17);var p=r(10);var g=r(117);var y=H(g);var S=r(202);var w=H(S);var E=r(118);var b=r(206);var M=r(485);var _=O(M);var C=r(508);var P=O(C);function H(e){if(e&&e.__esModule){return e}else{var t={};if(e!=null){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))t[r]=e[r]}}t.default=e;return t}}function O(e){return e&&e.__esModule?e:{default:e}}const x=e=>({searchInner:{padding:"5rem 2rem"},searchActions:{marginTop:"1.5rem"},disabled:{opacity:.6,pointerEvents:"none"},formLabelText:{order:0},formLabelRoot:{marginLeft:0},changesSaved:{display:"inline-flex",alignItems:"center",fontSize:".7rem",position:"relative",color:e.palette.primary.success,padding:"0 16px",transform:"translateX(-50%)",opacity:0,transition:".2s ease-in"},showSaved:{opacity:1,transform:"translateX(0)"},icon:{marginLeft:".5rem"}});class N extends s.Component{constructor(...e){var t;return t=super(...e),this.state={search:"",dialogOpen:false,notSaveHistory:false,changesSaved:false},this.componentDidMount=(()=>{const{user:e}=this.props;const{notSaveHistory:t}=this.state;if(e&&!e.saveHistory!=t){this.setState({notSaveHistory:!e.saveHistory})}}),this.onChangeHandler=(e=>{this.setState({search:e.target.value})}),this.openDialog=(()=>{this.setState({dialogOpen:true})}),this.closeDialog=(()=>{this.setState({dialogOpen:false})}),this.confirmClearHistory=(()=>{this.props.clearHistory();this.closeDialog()}),this.handleKeyPress=(e=>{const{search:t}=this.state;const{changeSearched:r,searchHistory:a,currentPage:s,pageSize:n}=this.props;if(e.keyCode==13&&t.length>4){a(t,s-1,n);r(t)}}),this.handleSaveHistoryChange=(e=>{this.setState(({notSaveHistory:e})=>{this.props.updateHistorySettings({saveHistory:!e==true?false:true});setTimeout(()=>{this.setState({changesSaved:false})},3e3);return{notSaveHistory:!e,changesSaved:true}})}),t}render(){const{classes:e,historyCount:t,loggedIn:r}=this.props;const{notSaveHistory:a,changesSaved:s}=this.state;return n.default.createElement(n.default.Fragment,null,n.default.createElement(P.default,{confirmDelete:this.confirmClearHistory,closeDialog:this.closeDialog,open:this.state.dialogOpen,title:"Clear history"},"Are you sure you want to clear your view history? This operation is irreversible."),n.default.createElement("div",{className:e.searchInner},n.default.createElement(_.default,{adornment:n.default.createElement(u.default,null),label:"Search in the view history",input:{value:this.state.search,onChange:this.onChangeHandler,onKeyUp:this.handleKeyPress}}),n.default.createElement("div",{className:e.searchActions},n.default.createElement(l.default,{onClick:this.openDialog,className:!r||t<1?e.disabled:""},"Clear history"),n.default.createElement("div",null,n.default.createElement("div",null,n.default.createElement(l.default,{onClick:this.handleSaveHistoryChange,className:!r?e.disabled:""},"Do not save my history"),n.default.createElement(m.default,{id:"saveHistory",checked:a,onChange:this.handleSaveHistoryChange,color:"primary"})),n.default.createElement("div",{className:[e.changesSaved,s?e.showSaved:""].join(" ")},"Changes saved ",n.default.createElement(f.default,{className:e.icon}))))))}}const D=e=>(0,p.bindActionCreators)(a({},y,w),e);const $=e=>({currentPage:(0,E.selectCurrentPage)(e.media.medias,"history"),pageSize:(0,E.selectPageSize)(e.media.medias,"history"),user:(0,b.selectUser)(e.user)});t.default=(0,v.connect)($,D)((0,o.withStyles)(x)(N))}}]);
//# sourceMappingURL=10.bundle.js.map